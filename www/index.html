<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	
    <title>بسم الله الرحمن الرحیم</title>
	
	<link rel="stylesheet" type="text/css" href="css/reset.css">
	<link rel="stylesheet" type="text/css" href="css/font.css" />
	<link rel="stylesheet" type="text/css" href="css/main.css">
    
	<script src="js/jquery-1.11.3.min.js"></script>
	<!--<script src="js/console.log.js"></script>-->
    <script src="phonegap.js"></script>
    <script src="js/fastclick.js"></script>
    <script src="js/jquery.md5.js"></script>
    <script src="js/back_btn.js"></script>
    <script src="js/scale.js"></script>
    <script src="js/jquery.touchSwipe.min.js"></script>
    <script src="js/jquery.slides.min.js"></script>
	<script src="PushNotification.js" type="text/javascript" ></script>
	
	<script>
		function init() {		
			console.log('SMGROUP ::::::::::::::::::::::::::::::::::::    start init()');
			document.addEventListener("deviceready", onDeviceReady, false);
			$("#slides").slidesjs({
				width: 400,
				//height: 400,
				navigation: {
					active: true,
					effect: "slide",//"slide"fade
				},
				pagination: {
					active: true,
					effect: "slide",//"slide"fade
				},
				effect: {
					fade: {
						speed: 800
					}
				},
				play: { auto: false},
				callback: {
					loaded: function(number) {
						// Do something awesome!
						// Passes start slide number
					},
					start: function(number) {
						// Do something awesome!
						// Passes slide number at start of animation
					},
					complete: function(number) {
						// Do something awesome!
						// Passes slide number at end of animation
					}
				}
			});
			//onDeviceReady();
		}


////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////
// START push Notification :////////////////////////////////////////////////////////////////
	 var register_for_notifs;// = window.localStorage.getItem('register_for_notifs');
	 function onNotificationGCM(e) {
		//alert("uuuuuu");
		//$("#app-status-ul").append('<li>EVENT -> RECEIVED:' + e.event + '</li>');

		switch( e.event )
		{
		case 'registered':
			if ( e.regid.length > 0 )
			{
				//$("#app-status-ul").append('<li>REGISTERED -> REGID:' + e.regid + "</li>");
				// Your GCM push server needs to know the regID before it can push to this device
				// here is where you might want to send it the regID for later use.
				//console.log("regID = " + e.regid);
				//alert("regID = " + e.regid);
				//if(register_for_notifs){
					$.ajax({ type: "POST",
							url: "http://jazebe.smgroup.ir/SMCMS_notification/RegisterDeviceIDtoDB.php", 
							data: {regID : e.regid,user:window.localStorage.getItem('uuid'),OS:device.platform},
							async: false,
							success : function(text)
							{
								//last_articles_version = text;
								console.log('SMGROUP ::::::::::::::::::::::::::::::::::::    Notification registration text : ' + text);
								window.localStorage.setItem('register_for_notifs','yes');
							}
					});
				//}
			}
		break;

		case 'message':
			// if this flag is set, this notification happened while we were in the foreground.
			// you might want to play a sound to get the user's attention, throw up a dialog, etc.
			if ( e.foreground )
			{
				//$("#app-status-ul").append('<li>--INLINE NOTIFICATION--' + '</li>');

				// if the notification contains a soundname, play it.
				//var my_media = new Media("/android_asset/www/"+e.soundname);
				//my_media.play();
			}
			else
			{  // otherwise we were launched because the user touched a notification in the notification tray.
				/*
				if ( e.coldstart )
				{
					$("#app-status-ul").append('<li>--COLDSTART NOTIFICATION--' + '</li>');
				}
				else
				{
					$("#app-status-ul").append('<li>--BACKGROUND NOTIFICATION--' + '</li>');
				}
				*/
			}
			
			//alert(e.payload.message);
			navigator.notification.alert(
				e.payload.message,  // message
				alertDismissed,         // callback
				'اطلاعیه',            // title
				'تائید'                  // buttonName
			);
			//alert(e.payload.msgcnt);
			/*
			$("#app-status-ul").append('<li>MESSAGE -> MSG: ' + e.payload.message + '</li>');
			$("#app-status-ul").append('<li>MESSAGE -> MSGCNT: ' + e.payload.msgcnt + '</li>');
			*/
		break;

		case 'error':
			//$("#app-status-ul").append('<li>ERROR -> MSG:' + e.msg + '</li>');
		break;

		default:
			//$("#app-status-ul").append('<li>EVENT -> Unknown, an event was received and we do not know what it is</li>');
		break;
	  }
	}
	function successHandler (result) {
		//alert('result = ' + result);
	}
	// result contains any error description text returned from the plugin call
	function errorHandler (error) {
		//alert('error = ' + error);
	}
// END push Notification ///////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////
		function onDeviceReady() {
			if(window.sessionStorage.getItem('session_rand') == null)
			{
				playAudioBackground("audio/salame.mp3");
				window.sessionStorage.setItem('session_rand',Math.random());				
			}

			/*
			$("body").swipe({
				swipe:function(event, direction, distance, duration, fingerCount){
					//$(this).text("You swiped " + direction + " for " + distance + "px" );
					//alert("You swiped " + direction + " for " + distance + "px" );
					if(direction=="right")
					{
						if ( device.platform == 'iOS' )
						{
							go_back_index();
						}
					}
				},
				threshold:100
			});
			*/
			
			if(window.sessionStorage.getItem('session_rand') == null)
			{
				window.sessionStorage.setItem('session_rand',Math.random());				
			}

			if(window.localStorage.getItem('uuid') == null)
				window.plugins.uniqueDeviceID.get(uniqueDeviceIDsuccess_index, uniqueDeviceIDfail_index);
			else
			{
				
			}
			window.sessionStorage.setItem('we_are_in',"index");
			//FastClick.attach(document.getElementById('container'));
			FastClick.attach(document.body);
			
			if ( device.platform == 'Android' ){//Android,iOS,win7=WinCE,win8=Win32NT
				document.addEventListener("backbutton", go_back_index, false);
			}
			if(window.sessionStorage.getItem('LOAD_URL') == null)
			{
				window.sessionStorage.setItem('LOAD_URL',JSON.stringify(["786","110"]));				
			}


////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////
// START push Notification :////////////////////////////////////////////////////////////////
			if(window.localStorage.getItem('register_for_notifs') == null)
			{
				pushNotification = window.plugins.pushNotification;
				console.log('SMGROUP ::::::::::::::::::::::::::::::::::::    register_for_notifs : no // ' + device.platform);
				if ( device.platform == 'android' || device.platform == 'Android' || device.platform == "amazon-fireos" ){
					pushNotification.register(successHandler,errorHandler,{"senderID":"804625540618","ecb":"onNotificationGCM"});
				} else {
					pushNotification.register(tokenHandler,errorHandler,{"badge":"true","sound":"true","alert":"true","ecb":"onNotificationGCM"});//"onNotificationAPN"});
				}
			}

			function tokenHandler(result) {
				console.log('SMGROUP ::::::::::::::::::::::::::::::::::::    Notification Callback Success! Result (ios) = '+result);
				//if(register_for_notifs){
					$.ajax({ type: "POST",
							url: "http://jazebe.smgroup.ir/SMCMS_notification/RegisterDeviceIDtoDB.php", 
							data: {regID : result,user:window.localStorage.getItem('uuid'),OS:device.platform},
							async: false,
							success : function(text)
							{
								//last_articles_version = text;
								console.log('SMGROUP ::::::::::::::::::::::::::::::::::::    Notification registration text : ' + text);
								window.localStorage.setItem('register_for_notifs','yes');
							}
					});
				//}
			}
// END push Notification ///////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////
			
		}
		function uniqueDeviceIDsuccess_index(uuid)
		{
			window.localStorage.setItem('uuid',uuid);
		};
		function uniqueDeviceIDfail_index(uuid)
		{
			//alert("uniqueDeviceIDfail" + uuid);
		};
		
		function loadcompeleted() {
			//$(".mypreload").html("");
		}
		$(window).load(function() {
			//$(".mypreload").html("");
		});

		function go_back_index() {
			navigator.notification.confirm(
				'آیا تمایل به خروج از برنامه را دارید؟',	// message
				onExitConfirm,								// callback
				'توجه',										// title
				['بله','خیر']								// buttonName
			);
		}
		function onExitConfirm(buttonIndex) {
			if(buttonIndex==1)
			{
				navigator.app.exitApp();
				/*
				if (navigator && navigator.app) {
					navigator.app.exitApp();
				} 
				else {
					if (navigator && navigator.device) {
						navigator.device.exitApp();
					}
				}
				*/
			}
			else
			{
				
			}
		}
	</script>	

		
		
		
		
</head>
<body onload="init();" style="background-color:#cfcfcf;text-align:center;overflow:hidden;width:100%;">
		<div class="container " id="container" >
			<div id="ajax" class="mypreload">
				<div style="z-index: 1000; border: medium none; margin: 0px; padding: 0px; width: 100%; height: 100%; top: 0px; left: 0px; background-color: #f0f0f0; opacity: 1; cursor: default; position: fixed;overflow:visible;" class="blockUI blockOverlay"></div>
				<div style="z-index: 1011; position: fixed; padding: 0px; margin: 0px; width: 100%; top: 28%; left: 0%; text-align: center;border: medium none;overflow:visible;" class="blockUI blockMsg blockPage"><img src="images/preloader.gif"></div>
				<div style="z-index: 1012; position: fixed; padding: 0px; margin: 0px; width: 100%; top: 50%; left: 0%; text-align: center;border: medium none;overflow:visible;height:500px;" class="blockUI blockMsg blockPage"><img src="images/loading.png" width="70%"></div>
			</div>
<script>
$(document).ready(function() {
	$(".slide_navigator").css("top",$(window).height() - 110);
	$(".slide_navigatorssssss").click(function(e) {
		//alert();
		e.preventDefault();
		//a.stop(!0);
		return a.next(a.options.navigation.effect)
	});
});
</script>
<style>
/*
#slides,.slidesjs-container{
  overflow-x: visible !important;
  overflow-y: auto !important;
}
*/

</style>
<!--
قبل سفر:
	پیشینه
	فضیلت زیارت
	کوله پشتی
	آداب و احکام
	مومنانه

در سفر:
	اخبار مرز
	نقشه
	زیارات
		روضه
	بعثت خون
	بی خواص
	شاعرانه
	حسینیه
	لغات پرکاربرد
	
	نائب الزیاره
-->
			<div id="slides">
				<div class="silde_frame slide5th" >
					<img src="images/slider/gh05.jpg" style="width:100%;" onclick="window.location.href='audio.html';" />
					<div class="slide_navigator">
						<div class="slide_navigator_bg"></div>
						<div class="slide_navigator_next slidesjs-next">پیشینه <img src="images/slider/next-btn.png"></div>
						<div class="slide_navigator_link">مومنانه</div>
						<div class="slide_navigator_previous slidesjs-previous">آداب و احکام <img src="images/slider/previous-btn.png"></div>
					</div>
				</div>
				<div class="silde_frame slide1th" >
					<img src="images/slider/gh01.jpg" style="width:100%;" onclick="window.location.href='map.html';" />
					<div class="slide_navigator">
						<div class="slide_navigator_bg"></div>
						<div class="slide_navigator_next slidesjs-next">فضیلت زیارت <img src="images/slider/next-btn.png"></div>
						<div class="slide_navigator_link">پیشینه</div>
						<div class="slide_navigator_previous slidesjs-previous">مومنانه <img src="images/slider/previous-btn.png"></div>
					</div>
				</div>
				<div class="silde_frame slide2th" >
					<img src="images/slider/gh02.jpg" style="width:100%;" onclick="window.location.href='ziyarat-ashura.html';" />
					<div class="slide_navigator">
						<div class="slide_navigator_bg"></div>
						<div class="slide_navigator_next slidesjs-next">کوله پشتی <img src="images/slider/next-btn.png"></div>
						<div class="slide_navigator_link">فضیلت زیارت</div>
						<div class="slide_navigator_previous slidesjs-previous">پیشینه <img src="images/slider/previous-btn.png"></div>
					</div>
				</div>
				<div class="silde_frame slide3th" >
					<img src="images/slider/gh03.jpg" style="width:100%;" onclick="window.location.href='roze.html';" />
					<div class="slide_navigator">
						<div class="slide_navigator_bg"></div>
						<div class="slide_navigator_next slidesjs-next">آداب و احکام <img src="images/slider/next-btn.png"></div>
						<div class="slide_navigator_link">کوله پشتی</div>
						<div class="slide_navigator_previous slidesjs-previous">فضیلت زیارت <img src="images/slider/previous-btn.png"></div>
					</div>
				</div>
				<div class="silde_frame slide4th" >
					<img src="images/slider/gh04.jpg" style="width:100%;" onclick="window.location.href='arabic.html';" />
					<div class="slide_navigator">
						<div class="slide_navigator_bg"></div>
						<div class="slide_navigator_next slidesjs-next">مومنانه <img src="images/slider/next-btn.png"></div>
						<div class="slide_navigator_link">آداب و احکام</div>
						<div class="slide_navigator_previous slidesjs-previous">کوله پشتی <img src="images/slider/previous-btn.png"></div>
					</div>
				</div>
				<a href="#" class="slidesjs-previous slidesjs-navigation"><i class="icon-chevron-left icon-large"></i></a>
				<a href="#" class="slidesjs-next slidesjs-navigation"><i class="icon-chevron-right icon-large"></i></a>
			</div>
		</div>
<!--
				<img src="images/slider/01.png" onclick="window.location.href='map.html';" />
				<img src="images/slider/02.png" onclick="window.location.href='ziyarat-ashura.html';" />
				<img src="images/slider/03.png" onclick="window.location.href='roze.html';" />
				<img src="images/slider/04.png" onclick="window.location.href='arabic.html';" />
				<img src="images/slider/05.png" onclick="window.location.href='audio.html';" />
				<img src="images/slider/06.png" />
				<img src="images/slider/07.png" />
-->
</body>
</html>